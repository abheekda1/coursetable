query SameCourseOrProfOfferings(
  $seasonCode: String!
  $crn: Int!
  $same_course_id: Int!
  $professor_ids: [String!]
  $hasEval: Boolean!
) {
  self: computed_listing_info(
    where: { season_code: { _eq: $seasonCode }, crn: { _eq: $crn } }
  ) {
    description
    requirements
    syllabus_url
    professor_names
    times_by_day
    section
    flag_info
    enrolled @include(if: $hasEval)
    last_enrollment @include(if: $hasEval)
    last_enrollment_same_professors @include(if: $hasEval)
    credits
    classnotes
    regnotes
    rp_attr
    final_exam

    # For searching/testing equality
    season_code
    crn
    course_code
    same_course_id
    professor_ids
  }
  others: computed_listing_info(
    where: {
      _or: [
        { same_course_id: { _eq: $same_course_id } }
        { professor_ids: { _has_keys_any: $professor_ids } }
      ]
    }
  ) {
    course @include(if: $hasEval) {
      evaluation_statistic {
        avg_workload
        avg_rating
      }
    }
    professor_info @include(if: $hasEval)
    professor_names
    syllabus_url

    # All this is needed to navigate to the next class
    season_code
    crn
    title
    course_code
    all_course_codes
    section
    skills
    areas
    extra_info
    description
    times_by_day
    same_course_id
    professor_ids
  }
}

query SearchEvaluationNarratives($season_code: String, $crn: Int) {
  listings(where: { season_code: { _eq: $season_code }, crn: { _eq: $crn } }) {
    course {
      evaluation_narratives {
        comment
        evaluation_question {
          question_text
          tag
        }
      }
      evaluation_ratings {
        rating
        evaluation_question {
          question_text
          options
          tag
        }
      }
      evaluation_statistic {
        enrolled
      }
    }
  }
}
